<div>投稿編集ページ</div>

<%= form_with model: @post, id: 'post_form' do |f| %>
  <%= render "public/shared/error_messages", resource: @post %>
  <!--タイトルフォーム-->
  <div class="field">
    <%= f.label :title, "タイトル" %><br />
    <%= f.text_field :title, autofocus: true %>
  </div>
  <!--画像プレビュー-->
  <div class="d-flex">
    <div>
      変更前の画像<br />
      <%= image_tag @post.get_post_image, style: "max-height:300px;" %>
    </div>
    <div>
      変更後の画像<br />
      <div id="previews"></div>
    </div>
  </div>
  <!--画像uploadフォーム-->
  <div class="image_field">
    <%= f.label :post_image, "画像" %>
    <%= f.file_field :post_image, accept:'post_image/*' %>
  </div>
  <!--内容フォーム-->
  <div class="field">
    <%= f.label :body, "内容" %><br />
    <%= f.text_area :body %>
  </div>

  <% unless @post.category == "通常" %>
    <div id="post-details">
      <%= f.fields_for :post_details do |detail_form| %>
        <%= render 'post_detail_fields', f: detail_form %>
      <% end %>
      <div class="links">
        <%= link_to_add_association '手順を追加', f, :post_details, class: 'btn btn-secondary' %>
      </div>
    </div>
  <% end %>

  <%= f.submit "投稿を更新" %>
<% end %>

<% if @post.user_id == current_user.id %>
  <div><%= link_to "投稿を削除する", post_path(@post), method: :delete %></div>
<% end %>